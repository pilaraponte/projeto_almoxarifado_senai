PRAGMA foreign_keys = ON;
CREATE TABLE IF NOT EXISTS usuarios ( id INTEGER PRIMARY KEY AUTOINCREMENT, nome TEXT NOT NULL, email TEXT NOT NULL UNIQUE, senha TEXT NOT NULL );
CREATE TABLE IF NOT EXISTS materiais ( id INTEGER PRIMARY KEY AUTOINCREMENT, nome TEXT NOT NULL, categoria TEXT NOT NULL, codigo TEXT UNIQUE, custo_unitario REAL, estoque_minimo INTEGER NOT NULL DEFAULT 0, estoque_atual INTEGER NOT NULL DEFAULT 0 );
CREATE TABLE IF NOT EXISTS movimentacoes ( id INTEGER PRIMARY KEY AUTOINCREMENT, tipo TEXT NOT NULL CHECK(tipo IN ('entrada','saida')), quantidade INTEGER NOT NULL, data TEXT NOT NULL, material_id INTEGER NOT NULL, usuario_id INTEGER NOT NULL, FOREIGN KEY(material_id) REFERENCES materiais(id), FOREIGN KEY(usuario_id) REFERENCES usuarios(id) );